# ------------------------------------------------------------------------
# OWASP ModSecurity Core Rule Set Plugin
# Copyright (c) 2021-2022 Core Rule Set project. All rights reserved.
#
# The OWASP ModSecurity Core Rule Set plugins are distributed under
# Apache Software License (ASL) version 2
# Please see the enclosed LICENSE file for full details.
# ------------------------------------------------------------------------

# IP-Monitor Plugin
# Plugin name: ipmanagement
# Plugin description: Allow dynamically adding/removing an IP from a managementing list
#   All requests from IPs in managementing list will be logged (even if they don't trigger
#   other rules)
# Rule ID block base: 9,500,000 (range is 1000, thus ID block base +1000)
# Plugin version: 0.0.1

# This plugin initialises the IP collection to be just the IP (not with appended
#   user-agent. This behaviour is essential for this plugin to work as expected.
#   Plugin must run before IP collection is initialised elsewhere (eg. CRS 901321)
# Changing IP collection from CRS 901321:
#     initcol:ip=%{remote_addr}_%{tx.ua_hash}
#   to:
#     initcol:ip=%{remote_addr}
#   means that CRS (and any other IP based rules), may have reduced granularity
#     as User-Agent will not be used to try and distringuish between multiple
#     users/clients coming from the same IP.


